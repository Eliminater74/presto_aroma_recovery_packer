#!/bin/bash
## Aroma recovery packer
## By marduk191
## email: marduk191@gmail.com
frmdata=$(
	yad --width=400 \
	 --title="Presto Aroma recovery packer - marduk191" \
	 --text="sdfas" \
	 --text="sdas" \
	 --text="sdasdas" \
	 --text="Please enter your details:" \
	 --image="13.jpg" \
	 --form --date-format="%-d %B %Y" --item-separator="," \
	 --field="Device Name:" \
	 --field="Recovery Name:" \
	 --field="Version Number:" \
	 --field="File Revision:" \
	 --field="Author Name:" \
	 --field="recovery.img location:" \
	 --button="Build" \
	 "Presto" "Recovery" "Version" "Revision" "Author" "Recovery location")

device=$(echo $frmdata | awk 'BEGIN {FS="|" } { print $1 }')
recoveryname=$(echo $frmdata | awk 'BEGIN {FS="|" } { print $2 }')
vernumber=$(echo $frmdata | awk 'BEGIN {FS="|" } { print $3 }')
revision=$(echo $frmdata | awk 'BEGIN {FS="|" } { print $4 }')
NOW=$(date +"%m%d%y")
author=$(echo $frmdata | awk 'BEGIN {FS="|" } { print $5 }')
recloc=$(echo $frmdata | awk 'BEGIN {FS="|" } { print $6 }')

pico ./output/zip/META-INF/com/google/android/aroma-config
pico ./changelogs.txt
cp $recloc ./output/zip
rm ./output/zip/META-INF/com/google/android/aroma/changelogs.txt
cp ./changelogs.txt ./output/zip/META-INF/com/google/android/aroma/changelogs.txt
cd output/zip
zip -r -q --exclude=*zip* $device.$recoveryname.recovery.$vernumber.$revision.$NOW-$author.zip * && echo "Success" || echo "Failure"
clear
ls -lh $device.$recoveryname.recovery.$vernumber.$revision.$NOW-$author.zip

